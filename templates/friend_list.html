<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { background: #0e1621; color: white; font-family: sans-serif; margin: 0; }
        
        /* Header */
        .header { 
            background: #17212b; 
            padding: 15px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            position: sticky; 
            top: 0; 
            z-index: 1000;
        }

        .friend-item { 
            display: flex; 
            align-items: center; 
            padding: 15px; 
            border-bottom: 1px solid #0e1621; 
            background: #17212b; 
            cursor: pointer; 
            text-decoration: none; 
            color: white; 
            transition: 0.2s;
        }
        .friend-item:hover, .friend-item:active { background: #242f3d; }
        
        /* Avatar ប្រើអក្សរកាត់នៃឈ្មោះ */
        .avatar { 
            width: 50px; 
            height: 50px; 
            background: #2481cc; 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-weight: bold; 
            font-size: 20px; 
            margin-right: 15px; 
            text-transform: uppercase;
            flex-shrink: 0;
        }
        
        .friend-info { flex-grow: 1; }
        .friend-info h4 { margin: 0; font-size: 16px; color: #fff; }
        .friend-info p { margin: 3px 0 0; font-size: 13px; color: #8ab4f8; font-family: monospace; }
        
        .search-box { padding: 10px; background: #0e1621; position: sticky; top: 60px; z-index: 999; }
        .search-box input { 
            width: 100%; 
            padding: 12px 15px; 
            border-radius: 10px; 
            border: 1px solid #242f3d; 
            background: #242f3d; 
            color: white; 
            box-sizing: border-box; 
            outline: none; 
            font-size: 15px;
        }
        .search-box input:focus { border-color: #2481cc; }

        .empty-state { text-align: center; margin-top: 50px; color: #808b99; }
    </style>
</head>
<body>
    <div class="header">
        <h2 style="color: white; margin: 0;">Rathana Chat <span style="color: #2481cc;">Bot</span></h2>
        <div style="display: flex; gap: 15px; align-items: center;">
            <a href="/settings" style="color: white; font-size: 22px; text-decoration: none;">⚙️</a>
        </div>
    </div>

    <div class="search-box">
        <input type="text" id="searchInput" placeholder="ស្វែងរកតាមឈ្មោះ ឬ លេខ ID...">
    </div>

    <div class="friend-list" id="friendListContainer">
        {% for friend in friends %}
        <a href="/chat?uid={{ friend.id }}" class="friend-item">
            <div class="avatar">{{ friend.name[0] }}</div>
            <div class="friend-info">
                <h4>{{ friend.name }}</h4>
                <p>ID: {{ friend.user_id_number }}</p>
            </div>
            <i class="fas fa-chevron-right" style="color: #242f3d; font-size: 12px;"></i>
        </a>
        {% endfor %}
    </div>

    <div id="noResult" class="empty-state" style="display: {% if friends %}none{% else %}block{% endif %};">
        <i class="fas fa-users fa-3x"></i>
        <p style="margin-top: 10px;">មិនឃើញមានមិត្តភក្តិឡើយ</p>
    </div>

    <script>
        // មុខងារស្វែងរកតាម ឈ្មោះ និង ID (Search Filter)
        document.getElementById('searchInput').addEventListener('input', function(e) {
            let filter = e.target.value.toLowerCase();
            let items = document.querySelectorAll('.friend-item');
            let found = false;
            
            items.forEach(item => {
                // ទាញយកអត្ថបទទាំងឈ្មោះ និង ID នៅក្នុង Item នីមួយៗ
                let text = item.innerText.toLowerCase();
                
                if(text.includes(filter)) {
                    item.style.display = "flex";
                    found = true;
                } else {
                    item.style.display = "none";
                }
            });

            // បង្ហាញសារ "មិនឃើញ" បើស្វែងរកមិនឃើញ
            document.getElementById('noResult').style.display = found ? "none" : "block";
        });
    </script>
</body>
</html>
